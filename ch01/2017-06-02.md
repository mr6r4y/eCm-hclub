# Hacking Club Ch01 - 2nd June 2017

## Basic Radare2 navigation

### Lets start

We open an executable in Radare2 with the following command:
```bash
r2 ./executable
```

If we need to make fixes or patches, we need 'write' permissions:
```bash
r2 -w ./executable
```
and the `-w` option is used.

For opening a session in the standard debugger (which is GDB in Linux):
```bash
r2 -d ./executable
```

For starting Radare2 and executing a script right after our file is loaded:
```bash
r2 -i ./radare_script.r2 ./executable
```

### Navigation

You are dropped at the `entry0` flag, which is the program entrypoint
described by a field in the executable format:

```
[0x08048310]>
```

The address between `[` and `]` is our current location in the file or memory.
In Radare2 this is our main navigation using the command line interface. Most of
the commands we execute implicitly take our current location.

When we are dealing with executable files (ELF, PE, MachO, etc), Radare2 is
kind enough to represent the space and addresses we can reach as if the file is
loaded in memory for execution. That is why we can see the file itself starting
from offset `[0x00000000]>`, but also we see the same file mapped to `[0x08048000]>`
(this is the standard memory address at which ELF32 is loaded into its process memory).

We can change our current location with `s` command. The parameter can be an address
or a `flag`:

```
[0x08048310]> s 0x08048000
[0x08048000]> s main
[0x08048470]>
```

### Help

Whenever in doubt about how to use a command - type `?` or command's first character and `?`:

```
[0x08048470]> ?
Usage: [.][times][cmd][~grep][@[@iter]addr!size][|>pipe] ; ...
Append '?' to any char command to get detailed help
Prefix with number to repeat command N times (f.ex: 3x)
|%var =valueAlias for 'env' command
| *[?] off[=[0x]value]    Pointer read/write data/values (see ?v, wx, wv)
| (macro arg0 arg1)       Manage scripting macros
| .[?] [-|(m)|f|!sh|cmd]  Define macro or load r2, cparse or rlang file
| =[?] [cmd]              Send/Listen for Remote Commands (rap://, http://, <fd>)
| /[?]                    Search for bytes, regexps, patterns, ..
| ![?] [cmd]              Run given command as in system(3)
| #[?] !lang [..]         Hashbang to run an rlang script
| a[?]                    Analysis commands
| b[?]                    Display or change the block size
| c[?] [arg]              Compare block with given data
| C[?]                    Code metadata (comments, format, hints, ..)
| d[?]                    Debugger commands
| e[?] [a[=b]]            List/get/set config evaluable vars
| f[?] [name][sz][at]     Add flag at current address
| g[?] [arg]              Generate shellcodes with r_egg
| i[?] [file]             Get info about opened file from r_bin
| k[?] [sdb-query]        Run sdb-query. see k? for help, 'k *', 'k **' ...
| m[?]                    Mountpoints commands
| o[?] [file] ([offset])  Open file at optional address
| p[?] [len]              Print current block with format and length
| P[?]                    Project management utilities
| q[?] [ret]              Quit program with a return value
| r[?] [len]              Resize file
| s[?] [addr]             Seek to address (also for '0x', '0x1' == 's 0x1')
| S[?]                    Io section manipulation information
| t[?]                    Types, noreturn, signatures, C parser and more
| T[?] [-] [num|msg]      Text log utility
| u[?]                    uname/undo seek/write
| V                       Enter visual mode (V! = panels, VV = fcngraph, VVV = callgraph)
| w[?] [str]              Multiple write operations
| x[?] [len]              Alias for 'px' (print hexadecimal)
| y[?] [len] [[[@]addr    Yank/paste bytes from/to memory
| z[?]                    Zignatures management
| ?[??][expr]             Help or evaluate math expression
| ?$?                     Show available '$' variables and aliases
| ?@?                     Misc help for '@' (seek), '~' (grep) (see ~??)
| ?:?                     List and manage core plugins
[0x08048470]> s?
|Usage: s  # Seek commands
| s                 Print current address
| s:pad             Print current address with N padded zeros (defaults to 8)
| s addr            Seek to address
| s-                Undo seek
| s- n              Seek n bytes backward
| s--               Seek blocksize bytes backward
| s+                Redo seek
| s+ n              Seek n bytes forward
| s++               Seek blocksize bytes forward
| s[j*=!]           List undo seek history (JSON, =list, *r2, !=names)
| s/ DATA           Search for next occurrence of 'DATA'
| s/x 9091          Search for next occurrence of \x90\x91
| s.hexoff          Seek honoring a base from core->offset
| sa [[+-]a] [asz]  Seek asz (or bsize) aligned to addr
| sb                Seek aligned to bb start
| sC[?] string      Seek to comment matching given string
| sf                Seek to next function (f->addr+f->size)
| sf function       Seek to address of specified function
| sg/sG             Seek begin (sg) or end (sG) of section or file
| sl[?] [+-]line    Seek to line
| sn/sp             Seek to next/prev location, as specified by scr.nkey
| so [N]            Seek to N next opcode(s)
| sr pc             Seek to register
| ss                Seek silently (without adding an entry to the seek history)
[0x08048470]>
```

### Analysis



### Printing

`p` is used to print 

## Calling functions

Lets see what is going under the hood when a function is called in a C program.
The sample we use is [func_call.c](samples/func_call.c). In order to track easily
the program flow numbers 1 to 3 are assigned to local variables and 4 to 6 are
passed as arguments.

## Function calling conventions